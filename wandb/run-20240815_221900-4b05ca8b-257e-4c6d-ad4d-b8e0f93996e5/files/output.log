[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/cuda/__init__.py:619: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
  0%|                                                                                                                      | 0/2000 [00:00<?, ?it/s]/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
  0%|                                                                                                              | 1/2000 [00:00<27:23,  1.22it/s]
number of parameters: 25.32M
running on device cpu































  5%|█████▎                                                                                                       | 98/2000 [01:03<20:12,  1.57it/s]
































 10%|██████████▊                                                                                                 | 200/2000 [02:06<18:36,  1.61it/s]

































 15%|████████████████▏                                                                                           | 299/2000 [03:12<19:37,  1.44it/s]


































 20%|█████████████████████▋                                                                                      | 401/2000 [04:21<19:11,  1.39it/s]

































 25%|██████████████████████████▉                                                                                 | 499/2000 [05:27<16:10,  1.55it/s]



































 30%|████████████████████████████████▍                                                                           | 600/2000 [06:37<15:09,  1.54it/s]






































 35%|█████████████████████████████████████▊                                                                      | 701/2000 [07:54<14:38,  1.48it/s]

































 40%|███████████████████████████████████████████▏                                                                | 800/2000 [08:59<15:40,  1.28it/s]


































 45%|████████████████████████████████████████████████▋                                                           | 901/2000 [10:08<12:55,  1.42it/s]


































 50%|█████████████████████████████████████████████████████▌                                                     | 1001/2000 [11:16<11:37,  1.43it/s]


































 55%|██████████████████████████████████████████████████████████▉                                                | 1101/2000 [12:24<09:43,  1.54it/s]


















 58%|██████████████████████████████████████████████████████████████                                             | 1159/2000 [13:02<09:27,  1.48it/s]
Traceback (most recent call last):
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./algorithms/in_context_learning/AD.py", line 284, in <module>
    train()
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/pyrallis/argparsing.py", line 158, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./algorithms/in_context_learning/AD.py", line 268, in train
    trainer.run()
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/in_context_learning/trainer.py", line 95, in run
    logits, self.loss = model(x)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./algorithms/in_context_learning/AD.py", line 192, in forward
    x = block(x)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/utils.py", line 219, in forward
    x = x + self.mlpf(self.ln_2(x))
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/utils.py", line 215, in <lambda>
    self.mlpf = lambda x: m.dropout(m.c_proj(m.act(m.c_fc(x))))  # MLP forward
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/dropout.py", line 59, in forward
    return F.dropout(input, self.p, self.training, self.inplace)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/functional.py", line 1295, in dropout
    return _VF.dropout_(input, p, training) if inplace else _VF.dropout(input, p, training)
KeyboardInterrupt