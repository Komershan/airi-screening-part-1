/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:168: DeprecationWarning: [33mWARN: Current gymnasium version requires that `Env.reset` can be passed a `seed` instead of using `Env.seed` for resetting the environment random number generator.
  logger.deprecation(
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:181: DeprecationWarning: [33mWARN: Current gymnasium version requires that `Env.reset` can be passed `options` to allow the environment initialisation to be passed additional information.
  logger.deprecation(
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:189: UserWarning: [33mWARN: The result returned by `env.reset()` was not a tuple of the form `(obs, info)`, where `obs` is a observation and `info` is a dictionary containing additional information. Actual type: `<class 'list'>`
  logger.warn(
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.observation_to_int to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.observation_to_int` for environment variables or `env.get_wrapper_attr('observation_to_int')` that will search the reminding wrappers.
  logger.warn(
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:232: UserWarning: [33mWARN: Expects `truncated` signal to be a boolean, actual type: <class 'NoneType'>
  logger.warn(
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:127: UserWarning: [33mWARN: The obs returned by the `step()` method should be an int or np.int64, actual type: <class 'list'>
  logger.warn(f"{pre} should be an int or np.int64, actual type: {type(obs)}")
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:159: UserWarning: [33mWARN: The obs returned by the `step()` method is not within the observation space.
  logger.warn(f"{pre} is not within the observation space.")
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.probs to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.probs` for environment variables or `env.get_wrapper_attr('probs')` that will search the reminding wrappers.
  logger.warn(
0 1 0.9956647438526277
6 1 0.9794907536282049
2 1 0.9552612359037524
4 1 0.9692567908334534
8 1 0.9681730328228986
7 0 0.020509246371795048
9 0 0.03182696717710138
9 0 0.03182696717710138
2 1 0.9552612359037524
4 1 0.9692567908334534
8 1 0.9681730328228986
7 0 0.020509246371795048
3 0 0.04473876409624758
5 0 0.030743209166546628
7 0 0.020509246371795048
9 0 0.03182696717710138
9 0 0.03182696717710138
4 1 0.9692567908334534
2 1 0.9552612359037524
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
3 0 0.04473876409624758
5 0 0.030743209166546628
7 0 0.020509246371795048
4 1 0.9692567908334534
9 0 0.03182696717710138
5 0 0.030743209166546628
4 1 0.9692567908334534
5 0 0.030743209166546628
7 0 0.020509246371795048
4 1 0.9692567908334534
5 0 0.030743209166546628
5 0 0.030743209166546628
4 1 0.9692567908334534
5 0 0.030743209166546628
5 0 0.030743209166546628
4 1 0.9692567908334534
5 0 0.030743209166546628
4 1 0.9692567908334534
5 0 0.030743209166546628
4 1 0.9692567908334534
3 0 0.04473876409624758
4 1 0.9692567908334534
8 1 0.9681730328228986
7 0 0.020509246371795048
4 1 0.9692567908334534
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
3 0 0.04473876409624758
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
3 0 0.04473876409624758
4 1 0.9692567908334534
8 1 0.9681730328228986
0 1 0.9956647438526277
4 1 0.9692567908334534
8 1 0.9681730328228986
0 1 0.9956647438526277
4 1 0.9692567908334534
3 0 0.04473876409624758
5 0 0.030743209166546628
0 1 0.9956647438526277
4 1 0.9692567908334534
0 1 0.9956647438526277
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
3 0 0.04473876409624758
8 1 0.9681730328228986
4 1 0.9692567908334534
6 1 0.9794907536282049
6 0 0.9794907536282049
2 1 0.9552612359037524
8 1 0.9681730328228986
6 1 0.9794907536282049
6 1 0.9794907536282049
8 1 0.9681730328228986
8 1 0.9681730328228986
2 1 0.9552612359037524
6 1 0.9794907536282049
8 1 0.9681730328228986
6 1 0.9794907536282049
8 1 0.9681730328228986
6 1 0.9794907536282049
8 1 0.9681730328228986
6 1 0.9794907536282049
8 1 0.9681730328228986
2 1 0.9552612359037524
6 1 0.9794907536282049
8 1 0.9681730328228986
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
1 0 0.004335256147372291
1 0 0.004335256147372291
1 0 0.004335256147372291
1 0 0.004335256147372291
4 1 0.9692567908334534
2 1 0.9552612359037524
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
2 1 0.9552612359037524
8 1 0.9681730328228986
8 1 0.9681730328228986
2 1 0.9552612359037524
2 1 0.9552612359037524
6 1 0.9794907536282049
8 1 0.9681730328228986
8 1 0.9681730328228986
4 1 0.9692567908334534
4 1 0.9692567908334534
2 1 0.9552612359037524
2 1 0.9552612359037524
6 1 0.9794907536282049
2 1 0.9552612359037524
2 0 0.9552612359037524
2 1 0.9552612359037524
2 1 0.9552612359037524
4 1 0.9692567908334534
0 1 0.9956647438526277
2 1 0.9552612359037524
6 1 0.9794907536282049
8 1 0.9681730328228986
6 1 0.9794907536282049
2 1 0.9552612359037524
6 1 0.9794907536282049
8 1 0.9681730328228986
6 1 0.9794907536282049
4 1 0.9692567908334534
6 1 0.9794907536282049
6 1 0.9794907536282049
4 1 0.9692567908334534
2 1 0.9552612359037524
1 0 0.004335256147372291
4 1 0.9692567908334534
1 0 0.004335256147372291
6 1 0.9794907536282049
2 1 0.9552612359037524
2 1 0.9552612359037524
3 0 0.04473876409624758
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
3 0 0.04473876409624758
3 0 0.04473876409624758
3 0 0.04473876409624758
8 1 0.9681730328228986
4 1 0.9692567908334534
3 0 0.04473876409624758
3 0 0.04473876409624758
8 0 0.9681730328228986
3 0 0.04473876409624758
8 1 0.9681730328228986
8 1 0.9681730328228986
3 0 0.04473876409624758
3 0 0.04473876409624758
8 1 0.9681730328228986
3 0 0.04473876409624758
3 0 0.04473876409624758
3 0 0.04473876409624758
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
3 0 0.04473876409624758
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
3 0 0.04473876409624758
8 1 0.9681730328228986
3 0 0.04473876409624758
4 1 0.9692567908334534
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
4 1 0.9692567908334534
8 1 0.9681730328228986
3 0 0.04473876409624758
3 0 0.04473876409624758
6 1 0.9794907536282049
6 1 0.9794907536282049
3 0 0.04473876409624758
3 0 0.04473876409624758
6 1 0.9794907536282049
0 1 0.9956647438526277
0 1 0.9956647438526277
8 1 0.9681730328228986
8 1 0.9681730328228986
0 1 0.9956647438526277
0 1 0.9956647438526277
4 1 0.9692567908334534
6 1 0.9794907536282049
8 1 0.9681730328228986
8 1 0.9681730328228986
0 1 0.9956647438526277
0 1 0.9956647438526277
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
4 1 0.9692567908334534
4 1 0.9692567908334534
2 1 0.9552612359037524
1 0 0.004335256147372291
6 1 0.9794907536282049
2 1 0.9552612359037524
2 1 0.9552612359037524
4 1 0.9692567908334534
8 1 0.9681730328228986
8 1 0.9681730328228986
0 1 0.9956647438526277
2 1 0.9552612359037524
0 1 0.9956647438526277
8 1 0.9681730328228986
0 1 0.9956647438526277
0 1 0.9956647438526277
6 1 0.9794907536282049
2 1 0.9552612359037524
2 1 0.9552612359037524
1 0 0.004335256147372291
6 1 0.9794907536282049
1 0 0.004335256147372291
1 0 0.004335256147372291
2 1 0.9552612359037524
2 1 0.9552612359037524
4 1 0.9692567908334534
8 1 0.9681730328228986
6 1 0.9794907536282049
2 1 0.9552612359037524
2 1 0.9552612359037524
4 1 0.9692567908334534
4 1 0.9692567908334534
4 1 0.9692567908334534
8 1 0.9681730328228986
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
8 1 0.9681730328228986
4 1 0.9692567908334534
1 0 0.004335256147372291
6 1 0.9794907536282049
8 1 0.9681730328228986
1 0 0.004335256147372291
4 1 0.9692567908334534
6 1 0.9794907536282049
2 1 0.9552612359037524
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
0 1 0.9956647438526277
4 1 0.9692567908334534
2 1 0.9552612359037524
2 1 0.9552612359037524
8 1 0.9681730328228986
8 1 0.9681730328228986
6 1 0.9794907536282049
6 1 0.9794907536282049
8 1 0.9681730328228986
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
1 0 0.004335256147372291
1 0 0.004335256147372291
1 0 0.004335256147372291
1 0 0.004335256147372291
4 1 0.9692567908334534
8 1 0.9681730328228986
8 1 0.9681730328228986
8 0 0.9681730328228986
8 1 0.9681730328228986
2 1 0.9552612359037524
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
3 0 0.04473876409624758
3 0 0.04473876409624758
3 0 0.04473876409624758
3 0 0.04473876409624758
3 0 0.04473876409624758
3 0 0.04473876409624758
3 0 0.04473876409624758
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
3 0 0.04473876409624758
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
3 0 0.04473876409624758
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
3 0 0.04473876409624758
3 0 0.04473876409624758
8 1 0.9681730328228986
3 0 0.04473876409624758
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
4 1 0.9692567908334534
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
3 0 0.04473876409624758
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
3 0 0.04473876409624758
8 1 0.9681730328228986
6 0 0.9794907536282049
6 0 0.9794907536282049
2 1 0.9552612359037524
4 1 0.9692567908334534
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
2 1 0.9552612359037524
4 1 0.9692567908334534
2 1 0.9552612359037524
2 1 0.9552612359037524
8 1 0.9681730328228986
8 1 0.9681730328228986
6 1 0.9794907536282049
2 1 0.9552612359037524
2 1 0.9552612359037524
4 1 0.9692567908334534
6 1 0.9794907536282049
4 1 0.9692567908334534
6 1 0.9794907536282049
4 1 0.9692567908334534
2 1 0.9552612359037524
0 1 0.9956647438526277
0 1 0.9956647438526277
1 0 0.004335256147372291
2 1 0.9552612359037524
1 0 0.004335256147372291
1 0 0.004335256147372291
2 1 0.9552612359037524
2 1 0.9552612359037524
0 1 0.9956647438526277
6 1 0.9794907536282049
2 1 0.9552612359037524
8 1 0.9681730328228986
8 1 0.9681730328228986
4 1 0.9692567908334534
6 1 0.9794907536282049
2 1 0.9552612359037524
4 1 0.9692567908334534
2 1 0.9552612359037524
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
4 1 0.9692567908334534
0 1 0.9956647438526277
1 0 0.004335256147372291
1 0 0.004335256147372291
1 0 0.004335256147372291
1 0 0.004335256147372291
2 1 0.9552612359037524
4 1 0.9692567908334534
4 1 0.9692567908334534
6 1 0.9794907536282049
6 1 0.9794907536282049
8 1 0.9681730328228986
8 0 0.9681730328228986
8 1 0.9681730328228986
2 1 0.9552612359037524
8 1 0.9681730328228986
2 1 0.9552612359037524
8 1 0.9681730328228986
4 1 0.9692567908334534
8 1 0.9681730328228986
6 1 0.9794907536282049
6 1 0.9794907536282049
4 1 0.9692567908334534
6 1 0.9794907536282049
8 1 0.9681730328228986
8 1 0.9681730328228986
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
6 1 0.9794907536282049
3 0 0.04473876409624758
3 0 0.04473876409624758
6 1 0.9794907536282049
4 1 0.9692567908334534
4 1 0.9692567908334534
8 1 0.9681730328228986
8 1 0.9681730328228986
0 1 0.9956647438526277
4 1 0.9692567908334534
4 1 0.9692567908334534
0 1 0.9956647438526277
8 1 0.9681730328228986
0 1 0.9956647438526277
0 1 0.9956647438526277
6 1 0.9794907536282049
2 1 0.9552612359037524
2 1 0.9552612359037524
8 1 0.9681730328228986
8 1 0.9681730328228986
3 0 0.04473876409624758
3 0 0.04473876409624758
8 1 0.9681730328228986
6 1 0.9794907536282049
8 1 0.9681730328228986
8 1 0.9681730328228986
8 0 0.96817303282289868
3 0 0.04473876409624758
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
8 1 0.9681730328228986
3 0 0.04473876409624758
8 1 0.9681730328228986
3 0 0.04473876409624758
3 0 0.04473876409624758
3
8 1 0.96817303282289868
2 1 0.9552612359037524
8 1 0.9681730328228986
4 1 0.9692567908334534
0 1 0.9956647438526277
2 1 0.9552612359037524
4
8 1 0.96817303282289868
6 1 0.97949075362820498
6 1 0.97949075362820498
8 1 0.96817303282289868
8 1 0.96817303282289868
4 1 0.96925679083345348
4 1 0.96925679083345348
4 1 0.96925679083345348
Traceback (most recent call last):
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./scripts/compare_arena.py", line 151, in <module>
    benchmark()
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/pyrallis/argparsing.py", line 158, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./scripts/compare_arena.py", line 143, in benchmark
    total_reward_model = run_env(checkpoint_model, config, agent_name=f"{checkpoint}", sampled_task=sampled_task, finish=False)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./scripts/compare_arena.py", line 58, in run_env
    action = model.get_action(environment.observation_to_int())
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/in_context_learning/AD.py", line 195, in get_action
    logits, loss = self.forward(torch.tensor([self.history[-self.config.block_size:]]))
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/in_context_learning/AD.py", line 170, in forward
    x = block(x)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/utils.py", line 180, in forward
    x = x + self.attn(self.ln_1(x))
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/utils.py", line 152, in forward
    att = att.masked_fill(self.bias[:,:,:T,:T] == 0, float('-inf'))
KeyboardInterrupt
4 1 0.96925679083345348