[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:168: DeprecationWarning: [33mWARN: Current gymnasium version requires that `Env.reset` can be passed a `seed` instead of using `Env.seed` for resetting the environment random number generator.
  logger.deprecation(
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:181: DeprecationWarning: [33mWARN: Current gymnasium version requires that `Env.reset` can be passed `options` to allow the environment initialisation to be passed additional information.
  logger.deprecation(
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:189: UserWarning: [33mWARN: The result returned by `env.reset()` was not a tuple of the form `(obs, info)`, where `obs` is a observation and `info` is a dictionary containing additional information. Actual type: `<class 'list'>`
  logger.warn(
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.observation_to_int to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.observation_to_int` for environment variables or `env.get_wrapper_attr('observation_to_int')` that will search the reminding wrappers.
  logger.warn(
Traceback (most recent call last):
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./scripts/compare_arena.py", line 176, in <module>
    benchmark()
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/pyrallis/argparsing.py", line 158, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./scripts/compare_arena.py", line 168, in benchmark
    total_reward_model = run_env(checkpoint_model, config, agent_name=f"{checkpoint}", sampled_task=sampled_task, finish=False)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./scripts/compare_arena.py", line 73, in run_env
    observation, reward, is_terminated, truncated, additional_info = environment.step(action)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/wrappers/time_limit.py", line 57, in step
    observation, reward, terminated, truncated, info = self.env.step(action)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/wrappers/order_enforcing.py", line 56, in step
    return self.env.step(action)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/wrappers/env_checker.py", line 49, in step
    return env_step_passive_checker(self.env, action)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py", line 208, in env_step_passive_checker
    result = env.step(action)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/environments/bandits.py", line 47, in step
    reward = int(self.rng.uniform(low=0, high=1) <= self.probs[action])
IndexError: index 10 is out of bounds for axis 0 with size 10