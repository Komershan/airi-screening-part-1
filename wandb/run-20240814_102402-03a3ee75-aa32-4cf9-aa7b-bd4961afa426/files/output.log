[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
  0%|                                                                                                                      | 0/1000 [00:00<?, ?it/s]/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
  0%|▌                                                                                                             | 5/1000 [00:01<03:04,  5.40it/s]
number of parameters: 25.38M
running on device cuda
4 3515
2 750
2 4634
3 401
0 5215
3 2945
3 1697
4 18
4611.3876953125
2 809
0 6804
1 5465
1 5279
4 4990
1 5488
4 4914
0 3044
1 5214
1 2734
3 1231
0 7676
3 67
1 7457
2 3019
2 898
0 3593
1 7414
3 4456
1 2830
1 5135
1 4763
4 4925
1 3566
0 5857
2 3609
4 3840
1 469
0 4501
2 3879
2 4701

  2%|██                                                                                                           | 19/1000 [00:03<02:18,  7.07it/s]
4 4498
2 7827
0 3176
0 7881
4 2651
1 307
4 2641
0 5571
2 4340
3 1562
4 257
0 221
1 398
0 5833
2 2121
1 3347
0 7341
4 4176
3 2788
3 6546
4 3252
1 2858
3 6557
1 668
2 6726
1 5685
1 5091
2 7687
0 6968
1 2766
4 4174
2 520
2 701
1 3736
3 2309
1 6371
1 3450
0 7750
4 197
2 5313
1 5417
0 7044
3 4178
0 4204
2 7645
0 4579
2 6707
4 7883
2 2036
3 2191
0 2752
5 73
2 7328
3 7083
2 590
4 967
4 5928
5 258
3 5902
3 5299
4 5432
4 1354
2 7001
4 4034
1 2058
3 2992
1 5624
0 6384
1 5098
0 2612
3 572
0 4779
3 6420
0 7637
4 158
3 6705
3 4970
1 2586
0 689
4 4006
2 6660
0 5775
0 1915
3 6198
2 3167
1 2431
1 4349
0 2615
2 4628
0 2414
3 602
3 4857
3 2201
4 2120
3 2532
0 498
1 7044
2 3304
2 7777
1 7328
0 5086
4 5478
2 2523
0 2476
3 571
3 2653
2 7889
2 497
1 3781
0 7497
3 3849

  3%|███▌                                                                                                         | 33/1000 [00:05<02:17,  7.06it/s]
2 1553
1 3163
2 3483
1 5186
2 4491
0 2104
0 3912
4 3271
2 4687
4 1234
3 6257
2 7874
3 2857
2 2610
2 1914
3 3343
1 3030
3 4816
1 6612
1 4706
0 400
3 5645
0 321
0 5294
4 6254
4 3201
2 2740
1 539
4 7725
1 3133
0 6495
3 5871
0 502
3 4737
1 4628
4 549
2 972
3 4106
1 4766
2 6387
3 7335
2 5290
2 7395
4 6128
4 5663
4 3969
2 2301
1 7358
0 7076
2 7177
0 6207
1 2838
5 379
3 3381
1 4360
3 4575
0 847
2 4778
0 524
0 6697
0 7406
4 538
1 2067
1 5915
1 4715
1 3046
1 207
0 3813
2 3446
3 4430
1 1775
0 1841
2 5227
1 4636
3 2919
1 2158
4 1333
1 4267
1 7582
4 3896
1 7704
4 1996
1 3134
1 2130
2 3892
0 7534
1 1841
1 2832
2 595
4 7396
1 427
2 1205
4 970
0 4344
4 7720
2 3496
4 4327
3 3308
2 6447
1 5518
2 4051
0 6445
1 4717
2 7761
1 6901
3 6103
3 3326
4 2819
0 6008
1 7816
0 285
2 1160
1 7613
4 762
2 4685
2 5702
1 854
5 222
1 2309

  5%|█████                                                                                                        | 47/1000 [00:07<02:14,  7.06it/s]
1 2005
0 1189
0 4539
2 7421
4 3110
3 7161
4 7096
1 6170
1 6861
2 4974
2 3980
1 3221
2 5405
3 2172
2 817
4 5439
0 7718
0 411
3 7148
2 1638
0 7105
2 1954
4 5706
0 3734
2 7646
0 7265
0 6722
3 2647
4 5562
0 6463
4 282
1 6909
0 7807
1 6238
3 2958
3 4676
0 5750
2 4719
0 6456
1 3346
4 4345
2 1139
2 2039
0 2730
0 6974
1 1397
2 3308
1 2030
2 7010
1 3088
3 5897
1 5846
1 2362
4 2165
3 3541
1 7070
3 1838
2 7421
3 1395
1 1726
0 77
2 234
4 842
2 5539
3 3222
0 5335
1 6209
4 1279
1 6836
4 2696
1 1607
4 6192
5 59
1 3900
3 6011
3 2344
3 1118
4 3964
1 311
1 2072
3 1546
0 5551
1 5351
1 3486
4 6982
4 578
0 2362
4 59
0 6163
2 2462
3 1752
3 5023
1 2535
4 2808
3 6294
2 3358
0 5475
1 4202
1 2648
3 1534
4 5530
3 7640
4 2138
0 229
3 2126
0 430
1 4607
1 3681
1 1318
4 3286
3 4209

  6%|██████▋                                                                                                      | 61/1000 [00:09<02:13,  7.04it/s]
0 328
0 7241
4 2305
0 7201
2 221
3 5903
4 6247
1 6941
2 5923
0 4185
1 7688
0 2177
4 4128
0 2994
3 5374
1 539
1 7779
4 6912
2 5481
4 3773
0 1195
1 489
0 2472
0 729
0 4427
1 2586
1 2690
3 7663
1 5728
5 219
2 7753
2 3559
0 4639
0 5803
4 2559
2 2920
0 6975
0 6738
4 4781
1 4002
0 1429
2 5195
0 3263
2 5097
0 7715
4 1868
4 7049
3 7063
1 2963
0 6784
1 6996
2 7770
2 191
0 3867
4 5210
3 4941
2 5632
2 1911
2 6475
1 4070
0 1018
4 1606
4 7866
5 254
4 4429
3 614
0 5348
4 7690
1 6917
4 6397
2 7489
2 6970
1 4092
2 4993
1 1933
4 6137
0 6032
4 5457
2 4340
4 1861
2 4371
1 4020
0 7819
1 3330
3 1418
1 3002
3 321
4 5105
1 7616
3 5118
4 15
2 1287
3 2755
4 7705
1 7542
0 6753
0 7416
1 1
4 6980
4 1847
2 2364
0 809
4 2119
2 5215
3 5227
2 2025
0 3444
4 6995
4 1336
4 5203
1 6264

  8%|████████▏                                                                                                    | 75/1000 [00:11<02:11,  7.03it/s]
3 3184
0 4745
1 4505
4 5609
0 3855
3 3869
4 1670
0 1995
5 353
4 3468
1 5449
1 5713
1 3300
4 6687
4 6471
3 7167
0 3632
1 1545
4 2779
1 3993
4 5316
2 2902
4 5206
4 1081
0 1527
5 344
1 5655
1 5317
3 6585
0 3142
3 4058
4 2763
0 2569
1 2977
2 3577
0 5882
1 7675
0 5471
0 5532
4 6921
4 3154
3 6304
2 2827
4 4355
0 631
1 5725
2 578
1 1571
3 5087
1 3695
4 4689
3 4427
2 2548
4 7422
2 1461
0 1861
1 4743
0 52
1 4811
4 1488
0 3229
0 6198
3 5101
4 5271
2 781
4 6985
4 5063
2 4271
0 633
4 7054
4 659
0 5903
2 5752
3 2801
2 3079
0 6654
4 2896
2 454
3 4271
0 1705
5 255
1 918
1 4692
1 442
3 5454
0 1161
2 1199
0 7419
0 6604
2 3468
0 7303
4 2559
4 6146
1 2419
1 2724
0 5160
0 5800
0 7067
2 3321
0 3135
0 5975
4 3586
2 3911
4 6334
1 5127
4 2355
2 3766
2 3783
4 6331
4 2306
0 3025

  9%|█████████▋                                                                                                   | 89/1000 [00:13<02:09,  7.03it/s]
4 6202
4 3995
0 2218
4 1687
1 6029
4 2467
4 6454
4 5052
3 3391
0 1289
3 2426
2 596
1 3908
2 7343
0 6531
1 6750
3 7259
4 2148
0 323
0 5438
0 5901
0 4179
3 3923
0 5926
4 3803
1 7646
0 6846
1 3307
5 0
4 6430
0 5052
0 6220
3 5838
4 4081
4 3266
3 2554
1 4012
0 5741
0 4967
0 5234
4 3907
4 5597
3 1816
3 5378
5 355
3 5322
0 4402
2 1348
3 4017
2 7475
4 4101
2 1292
1 6214
4 2891
2 4042
1 2708
4 593
4 7802
2 5900
4 2042
1 5760
2 3789
1 2401
4 7460
1 4866
4 5990
0 3863
2 5255
3 690
2 1006
0 6819
5 81
2 7229
2 5664
1 1785
1 1172
4 3047
1 166
4 1200
1 2697
3 3925
4 1062
2 7810
3 1723
4 5231
2 4799
4 5544
2 7894
0 3942
4 954
0 648
0 5392
0 2725
3 2584
3 7673
4 3876
1 5995
3 5180
2 3789
3 3293
4 5551
0 705
1 5467
0 7203
1 6941
3 7005
1 6577
2 192
1 2488
2 3809
4 3236

 10%|███████████                                                                                                 | 103/1000 [00:15<02:02,  7.30it/s]
2 1733
4 2837
1 2315
4 2917
2 4683
1 490
0 5990
1 6967
3 5997
3 7287
1 6431
4 135
2 5248
3 4769
3 374
2 1279
3 1338
1 7051
5 10
3 7759
1 6742
3 4105
0 4714
1 2766
1 7775
3 6194
3 4849
0 1172
3 264
0 4222
4 2521
2 6661
1 5952
0 3607
1 594
2 6648
0 3410
3 233
2 4437
3 7711
4 21
1 6519
0 6978
4 7333
2 2771
3 5383
2 4047
3 1835
4 5137
2 5425
4 802
1 4405
0 3812
2 7060
2 4436
0 2618
1 4571
3 776
2 2747
3 3513
0 3716
2 3813
4 3260
2 1662
3 21
3 5759
2 4436
5 228
3 4927
1 3219
4 6423
2 4145
1 133
2 3865
1 3276
4 7078
0 3488
0 6870
4 6883
0 2393
3 6750
4 1267
1 7014
0 4708
0 1455
1 1356
3 6903
2 263
3689.75830078125
0 1109
4 3637
2 621
1 722
2 7746
1 852
2 4440
3 4428
2 1663
1 553
2 959
3 1584
0 926
1 491
2 6522
0 1667
4 2039
2 7168
1 3298
2 4989
5 287
1 5835
4 6116

 12%|████████████▋                                                                                               | 117/1000 [00:17<02:05,  7.04it/s]
0 218
4 3592
0 4400
2 6289
1 584
2 2413
2 5053
2 536
2 2777
2 6742
4 2234
2 7822
1 3922
4 7646
0 7114
4 4854
0 376
2 6486
4 3570
3 7272
2 7578
4 7702
2 6827
4 4479
4 2997
2 7226
4 391
1 1628
0 7454
0 2668
0 7550
1 2955
3 83
3 2243
3 1872
1 7623
2 4902
1 537
2 599
1 6115
0 6711
2 5798
0 6936
0 3282
4 5671
0 3617
4 3713
1 4637
0 2059
3 5791
2 5491
3 134
3 6898
0 6663
4 1302
0 5227
2 4197
0 4771
3 3779
3 3335
3 354
4 2880
0 4618
3 3261
1 5784
3 4116
3 7783
1 1227
0 1695
4 2812
1 1646
1 2011
1 3485
4 3347
1 4040
2 7029
0 1988
4 7324
4 1731
1 3961
1 7189
0 4376
3 7370
0 3885
3 7653
3 5246
0 1727
1 3935
3 1091
3 7379
0 6787
0 7788
1 1555
4 1659
0 1627
4 7233
1 55
1 94
3 479
0 2783
0 2083
0 6198
3 963
3 2012
1 6369
4 6575
5 186
0 5331
1 3099
1 5119
3 1921

 13%|██████████████▏                                                                                             | 131/1000 [00:19<02:03,  7.03it/s]
5 21
4 472
2 5590
0 455
0 306
2 5720
4 4234
1 2820
1 7888
4 7235
1 4988
3 2090
1 6288
0 5807
3 3610
0 6059
0 6125
1 3988
3 5365
0 3348
0 5133
4 2333
1 1290
2 2838
3 7145
1 6022
4 679
2 1936
0 7080
3 7229
1 5268
1 6001
4 1768
3 7057
1 6558
4 7375
1 2840
3 1742
4 3334
1 7660
0 7384
0 3882
2 6908
1 2472
4 1869
1 5261
0 6057
0 4015
1 6701
3 1892
3 7272
0 4677
0 1573
1 2436
3 5800
3 418
3 7264
3 7559
0 1628
4 3434
2 6775
2 2349
0 5749
3 2612
3 3780
2 6016
5 271
0 1208
0 1685
3 3439
2 643
2 7127
5 384
2 2384
4 1003
0 5684
4 5531
4 3753
0 4478
1 3665
0 419
2 5045
4 3374
4 3734
0 2582
0 4953
0 6456
4 7248
0 3453
0 2790
2 6824
2 468
2 7761
0 1130
3 3379
3 2609
2 6870
0 1982
3 5317
0 822
0 1933
0 2219
2 7679
2 6803
0 3
4 30
1 3519
0 4604
1 5961
2 6230
0 1150

 15%|███████████████▊                                                                                            | 146/1000 [00:21<02:01,  7.03it/s]
3 5891
4 4030
2 1320
1 3821
1 4179
2 937
2 6907
4 6534
3 797
2 4836
1 3155
4 3251
3 7731
0 7865
0 281
4 6652
3 5458
4 2921
2 7068
1 1614
3 1484
0 2445
2 5912
0 3614
2 4014
2 495
1 5498
0 4685
4 5797
2 6795
1 845
2 4817
1 537
4 6734
3 4822
4 6499
3 2212
4 4031
2 7852
3 1736
4 7303
4 5933
2 3146
2 4463
1 909
0 2583
3 2205
1 4683
0 6284
3 3964
2 6199
0 6734
2 4935
3 5634
2 2199
2 2764
1 2180
4 219
3 2685
3 5933
2 7476
3 7128
2 5992
1 7455
0 5238
4 6407
2 2117
0 4471
5 29
1 6816
3 4856
0 336
1 1269
0 7813
2 7626
1 511
0 4473
1 3729
3 861
4 5510
1 5915
0 360
0 2530
0 3319
3 1041
2 5677
4 718
3 4293
2 623
1 6701
3 3168
1 3022
4 3997
3 2102
2 222
3 6207
1 3762
1 1507
1 5808
4 4557
3 7545
4 6623
3 7898
3 2606
1 2827
1 2327
2 4415
1 7630
4 4940
1 7360
1 7762

 16%|█████████████████▎                                                                                          | 160/1000 [00:23<02:00,  6.99it/s]
3 1460
3 7585
0 1073
4 2323
2 1184
0 657
1 6905
1 3210
0 3932
4 7774
4 4966
0 6545
1 6703
0 2583
0 312
4 5583
0 3350
0 1405
3 3722
2 7124
1 3377
3 1762
2 7795
3 7565
0 7445
0 3114
1 6525
3 2738
2 6596
1 2379
1 4249
1 7321
4 3813
0 3423
0 3987
2 492
1 1797
2 6386
3 2614
2 3620
0 3718
2 4832
0 7867
3 873
4 7535
4 3111
2 3204
2 659
1 478
3 4862
1 1739
2 6089
4 4160
1 1497
4 7228
1 6770
4 6180
1 495
2 1197
0 2914
3 7304
0 4502
4 5953
1 4404
1 1237
4 761
2 4590
3 6022
0 7082
3 1217
2 3247
3 4428
2 6237
1 5337
1 6432
0 2627
0 5180
0 642
0 1338
1 1113
2 6934
2 2613
4 827
1 287
1 1
0 2667
3 5539
4 3677
3 4788
3 5544
1 7292
3 5054
4 2783
0 4833
0 6019
3 2806
3 7210
1 7682
1 6096
2 2918
2 4108
3 2219
2 4389
4 6790
4 4604
5 11
0 7153
0 3871
1 2874
2 4463
4 6795

 17%|██████████████████▊                                                                                         | 174/1000 [00:25<01:58,  6.97it/s]
3 7119
4 342
4 833
4 3054
0 750
1 7190
1 543
0 4422
3 892
4 4454
2 1762
3 3336
0 7261
4 34
1 3527
1 5401
0 3952
0 779
0 5562
1 2341
4 5704
3 3617
2 1697
0 2407
2 7854
4 1555
0 5849
0 4512
0 5909
2 1899
1 6198
2 6695
4 4340
0 4315
3 5807
3 7628
0 766
2 4663
0 3541
0 7831
3 3579
3 3614
1 7069
0 6371
0 2111
1 4121
4 5709
4 4173
4 463
2 5690
0 4784
1 497
4 2201
4 1766
1 5063
2 1087
1 560
3 5545
4 1942
2 3342
2 7198
2 6820
0 3721
0 4719
3 2477
4 7305
0 2467
4 4055
0 3342
3 4615
3 1340
1 803
4 1481
2 1907
2 775
3 7771
3 1938
1 926
0 3268
2 7195
2 7655
4 7725
0 844
0 5948
4 7425
1 1997
0 1822
0 881
1 756
4 2391
1 7383
2 2460
2 3152
1 7145
4 4675
3 2602
3 1340
1 6714
2 1992
1 3504
0 2910
0 1114
0 7090
3 7802
2 7235
4 7531
2 172
4 6768
4 2116
0 1313
4 1661
 18%|███████████████████▋                                                                                        | 182/1000 [00:26<01:59,  6.87it/s]
Traceback (most recent call last):
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./algorithms/in_context_learning/AD.py", line 253, in <module>
    train()
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/pyrallis/argparsing.py", line 158, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./algorithms/in_context_learning/AD.py", line 235, in train
    trainer.run()
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/in_context_learning/trainer.py", line 94, in run
    logits, self.loss = model(x)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./algorithms/in_context_learning/AD.py", line 181, in forward
    mask = torch.tensor(np_mask * random_probs > self.config.mask_prob, dtype=torch.float64).to(device)
KeyboardInterrupt
0 2407
4 3800
2 4121
4 5362
4 6247
2 6024
4 667
4 157
0 4350
3 5890
4 2827
3 6005
1 7758
4 701
2 7661
4 753
4 1001
1 7070
1 1976
1 5416
1 3500
1 6192
2 5424
3 2133
2 3902
1 3328
2 6576
4 1635
3 6808
4 2376
4 1955
0 1739
2 5079
0 2410
2 3911
3 1640
3 4231
2 3653
4 4944
3 3048
3 4136
4 7447
3 2318
2 6836
0 958
2 1184
1 4215
0 7633
3 6662
1 4564
4 1005
1 3063
1 7214
3 2557
2 405
1 731
0 6921
5 366
1 4370
4 4451
2 2113
1 2925
3 4216
2 2547
0 2818
4 1147
2 7229
2 5391
3 2633
2 3558
4 6927
1 349