[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
  0%|                                                                                                                    | 0/100000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./algorithms/in_context_learning/AD.py", line 256, in <module>
    train()
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/pyrallis/argparsing.py", line 158, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./algorithms/in_context_learning/AD.py", line 238, in train
    trainer.run()
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/in_context_learning/trainer.py", line 94, in run
    logits, self.loss = model(x)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./algorithms/in_context_learning/AD.py", line 169, in forward
    x = self.transformer.drop(tok_emb + pos_emb)
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
number of parameters: 25.28M
running on device cuda
tensor([[62,  1,  0, 53,  3,  0, 62,  2,  0, 40,  1,  0, 31,  2,  0, 32,  1,  0,
         23,  3,  0, 32,  2,  0, 33,  3,  0, 42,  1,  0, 33,  3,  0, 42,  3,  0,
         51,  2,  0, 52,  3,  0, 61,  2,  0, 62,  1,  0, 53,  3,  0, 62,  2,  0,
         62,  2,  0, 62,  1,  0, 53,  1,  0, 44,  1,  0, 35,  0,  0, 40,  2,  0,
         41,  2,  0, 42,  3,  0, 51,  3,  0, 60,  3,  0, 69,  2,  1, 70,  1,  0,
         61,  2,  0, 62,  3,  0, 71,  1,  0, 62,  2,  0, 62,  2,  0, 62,  3,  0,
         71,  3,  0, 80,  2,  0, 80,  2,  0, 80,  1,  0],
        [22,  3,  0, 31,  1,  0, 22,  3,  0, 31,  1,  0, 22,  3,  0, 31,  1,  0,
         22,  2,  0, 23,  2,  0, 24,  2,  0, 25,  2,  0, 26,  4,  0, 25,  2,  0,
         26,  2,  0, 26,  2,  0, 26,  0,  0, 26,  2,  0, 40,  1,  0, 31,  1,  0,
         22,  2,  0, 23,  2,  0, 24,  2,  0, 25,  2,  0, 26,  4,  0, 25,  2,  0,
         26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0,
         26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0,
         40,  1,  0, 31,  1,  0, 22,  3,  0, 31,  4,  0],
        [31,  2,  0, 32,  1,  0, 23,  2,  0, 24,  2,  0, 25,  2,  0, 26,  2,  0,
         26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0,
         26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0,
         40,  1,  0, 31,  1,  0, 22,  2,  0, 23,  2,  0, 24,  2,  0, 25,  2,  0,
         26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0,
         26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0, 26,  2,  0,
         26,  2,  0, 26,  2,  0, 40,  1,  0, 31,  1,  0],
        [16,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1,
         17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1,
         17,  2,  1, 17,  2,  1, 40,  1,  0, 31,  1,  0, 22,  1,  0, 13,  2,  0,
         14,  2,  0, 15,  2,  0, 16,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1,
         17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1,
         17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 40,  1,  0, 31,  1,  0,
         22,  1,  0, 13,  2,  0, 14,  2,  0, 15,  2,  0],
        [39,  3,  0, 48,  0,  0, 48,  1,  0, 39,  0,  0, 39,  2,  0, 40,  3,  0,
         49,  3,  0, 58,  0,  0, 58,  4,  0, 57,  3,  0, 66,  2,  0, 67,  3,  0,
         76,  3,  0, 76,  4,  0, 75,  0,  0, 75,  3,  0, 75,  4,  0, 74,  1,  0,
         65,  3,  0, 40,  1,  0, 31,  3,  0, 40,  4,  0, 39,  0,  0, 39,  3,  0,
         48,  1,  0, 39,  2,  0, 40,  0,  0, 40,  3,  0, 49,  4,  0, 48,  2,  0,
         49,  3,  0, 58,  2,  0, 59,  2,  0, 60,  1,  0, 51,  1,  0, 42,  1,  0,
         33,  1,  0, 24,  3,  0, 33,  3,  0, 40,  4,  0],
        [16,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1,
         17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1,
         17,  2,  1, 17,  2,  1, 40,  1,  0, 31,  1,  0, 22,  1,  0, 13,  2,  0,
         14,  2,  0, 15,  2,  0, 16,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1,
         17,  2,  1, 17,  2,  1, 17,  3,  0, 26,  1,  1, 17,  2,  1, 17,  2,  1,
         17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 40,  1,  0, 31,  1,  0,
         22,  1,  0, 13,  2,  0, 14,  2,  0, 15,  2,  0],
        [17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1,
         40,  1,  0, 31,  1,  0, 22,  1,  0, 13,  2,  0, 14,  2,  0, 15,  2,  0,
         16,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1,
         17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1,
         17,  2,  1, 17,  2,  1, 40,  1,  0, 31,  1,  0, 22,  1,  0, 13,  2,  0,
         14,  2,  0, 15,  2,  0, 16,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1,
         17,  2,  1, 17,  2,  1, 17,  2,  1, 17,  2,  1],
        [31,  4,  0, 30,  1,  0, 21,  4,  0, 20,  4,  0, 19,  4,  1, 18,  4,  1,
         18,  4,  1, 18,  4,  1, 18,  4,  1, 18,  4,  1, 18,  4,  1, 18,  4,  1,
         18,  4,  1, 18,  4,  1, 18,  4,  1, 18,  4,  1, 18,  4,  1, 18,  4,  1,
         18,  4,  1, 40,  1,  0, 31,  4,  0, 30,  1,  0, 21,  4,  0, 20,  4,  0,
         19,  4,  1, 18,  4,  1, 18,  4,  1, 18,  4,  1, 18,  4,  1, 18,  4,  1,
         18,  4,  1, 18,  4,  1, 18,  4,  1, 18,  4,  1, 18,  4,  1, 18,  4,  1,
         18,  4,  1, 18,  4,  1, 18,  4,  1, 40,  1,  0]], device='cuda:0')