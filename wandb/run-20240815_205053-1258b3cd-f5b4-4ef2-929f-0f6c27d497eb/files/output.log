[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/cuda/__init__.py:619: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_seed to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_seed` for environment variables or `env.get_wrapper_attr('set_seed')` that will search the reminding wrappers.
  logger.warn(
  0%|                                                                                                                     | 0/10000 [00:00<?, ?it/s]
[40  0  0 40  3  0 49  1  0 40  1  0 31  0  0 31  0  0 31  0  0 31  1  0
 22  3  0 31  3  0 40  1  0 31  3  0 40  3  0 49  0  0 49  4  0 48  0  0
 48  0  0 48  3  0 57  0  0 57  0  0]
[40  3  0 49  0  0 49  0  0 49  0  0 49  0  0 49  0  0 49  0  0 49  0  0
 49  0  0 49  0  0 49  0  0 49  0  0 49  3  0 58  0  0 58  0  0 58  0  0
 58  0  0 58  0  0 58  0  0 58  0  0]
[40  0  0 40  0  0 40  0  0 40  0  0 40  3  0 49  0  0 49  0  0 49  0  0
 49  0  0 49  0  0 49  3  0 58  4  0 57  0  0 57  0  0 57  0  0 57  3  0
 66  0  0 66  0  0 66  0  0 66  0  0]
[40  1  0 31  4  0 30  0  0 30  1  0 21  0  0 21  3  0 30  1  0 21  4  0
 20  1  0 11  4  0 10  0  0 10  3  0 19  0  0 19  0  0 19  0  0 19  0  0
 19  4  0 18  0  0 18  1  0  9  4  0]
[40  4  0 39  3  0 48  1  0 39  3  0 48  1  0 39  3  0 48  1  0 39  3  0
 48  4  0 47  4  0 46  3  0 55  1  0 46  1  0 37  1  0 28  3  0 37  1  0
 28  1  0 19  1  0 10  4  0  9  0  0]
[40  1  0 31  1  0 22  0  0 22  3  0 31  3  0 40  1  0 31  3  0 40  0  0
 40  4  0 39  1  0 30  4  0 29  4  0 28  4  0 27  4  0 27  1  0 18  4  0
 18  1  0  9  4  0  9  0  0  9  4  0]
[40  1  0 31  4  0 30  1  0 21  1  0 12  1  0  3  3  0 12  0  0 12  4  0
 11  4  0 10  1  0  1  1  0  1  3  0 10  2  0 11  3  0 20  1  0 11  0  0
 11  0  0 11  1  0  2  3  0 11  3  0]
[40  0  0 40  4  0 39  0  0 39  4  0 38  4  0 37  1  0 28  0  0 28  4  0
 27  3  0 36  1  0 27  1  0 18  3  0 27  4  0 27  0  0 27  1  0 18  3  0
 27  1  0 18  4  0 18  1  0  9  1  0]
[40  3  0 49  1  0 40  0  0 40  4  0 39  1  0 30  4  0 29  4  0 28  4  0
 27  1  0 18  4  0 18  1  0  9  0  0  9  4  0  9  1  0  0  2  0  1  3  0
 10  0  0 10  3  0 19  1  0 10  3  0]
[40  1  0 31  1  0 22  4  0 21  0  0 21  4  0 20  4  0 19  0  0 19  1  0
 10  1  0  1  1  0  1  0  0  1  0  0  1  2  0  2  1  0  2  0  0  2  1  0
  2  3  0 11  0  0 11  1  0  2  0  0]
[40  1  0 31  0  0 31  4  0 30  4  0 29  4  0 28  0  0 28  4  0 27  3  0
 36  4  0 36  4  0 36  3  0 45  0  0 45  1  0 36  3  0 45  4  0 45  0  0
 45  4  0 45  1  0 36  2  0 37  4  0]
[40  1  0 31  4  0 30  1  0 21  2  0 22  1  0 13  3  0 22  1  0 13  4  0
 12  0  0 12  4  0 11  3  0 20  0  0 20  4  0 19  1  0 10  0  0 10  3  0
 19  4  0 18  4  0 18  4  0 18  1  0]
[40  4  0 39  4  0 38  1  0 29  1  0 20  1  0 11  1  0  2  4  0  1  3  0
 10  0  0 10  4  0  9  1  0  0  0  0  0  3  0  9  1  0  0  0  0  0  1  0
  0  1  0  0  1  0  0  0  0  0  2  0]
[40  4  0 39  4  0 38  4  0 37  0  0 37  0  0 37  1  0 28  1  0 19  3  0
 28  1  0 19  4  0 18  0  0 18  4  0 18  0  0 18  0  0 18  3  0 27  4  0
 27  3  0 36  4  0 36  4  0 36  4  0]
[40  1  0 31  4  0 30  4  0 29  1  0 20  4  0 19  4  0 18  1  0  9  4  0
  9  1  0  0  4  0  0  3  0  9  0  0  9  3  0 18  1  0  9  1  0  0  4  0
  0  1  0  0  2  0  1  2  0  2  4  0]
[40  4  0 39  4  0 38  1  0 29  4  0 28  4  0 27  3  0 36  4  0 36  1  0
 27  1  0 18  3  0 27  4  0 27  4  0 27  4  0 27  0  0 27  1  0 18  0  0
 18  3  0 27  4  0 27  4  0 27  1  0]
[40  4  0 39  1  0 30  4  0 29  1  0 20  0  0 20  3  0 29  4  0 28  0  0
 28  1  0 19  1  0 10  3  0 19  1  0 10  4  0  9  4  0  9  1  0  0  2  0
  1  3  0 10  1  0  1  3  0 10  1  0]
[40  4  0 39  3  0 48  4  0 47  4  0 46  1  0 37  4  0 36  4  0 36  4  0
 36  4  0 36  4  0 36  4  0 36  1  0 27  4  0 27  1  0 18  1  0  9  4  0
  9  3  0 18  4  0 18  1  0  9  3  0]
[40  1  0 31  0  0 31  4  0 30  3  0 39  4  0 38  4  0 37  4  0 36  1  0
 27  4  0 27  4  0 27  1  0 18  0  0 18  1  0  9  0  0  9  0  0  9  1  0
  0  3  0  9  1  0  0  4  0  0  1  0]
[40  4  0 39  1  0 30  4  0 29  3  0 38  1  0 29  4  0 28  1  0 19  1  0
 10  3  0 19  0  0 19  3  0 28  4  0 27  0  0 27  1  0 18  4  0 18  4  0
 18  0  0 18  4  0 18  4  0 18  1  0]
[40  1  0 31  4  0 30  1  0 21  0  0 21  1  0 12  1  0  3  0  0  3  3  0
 12  4  0 11  1  0  2  3  0 11  0  0 11  1  0  2  3  0 11  0  0 11  3  0
 20  4  0 19  2  0 20  1  0 11  3  0]
[40  4  0 39  0  0 39  1  0 30  0  0 30  4  0 29  4  0 28  4  0 27  4  0
 27  1  0 18  4  0 18  0  0 18  3  0 27  0  0 27  3  0 36  1  0 27  1  0
 18  1  0  9  3  0 18  1  0  9  4  0]
[40  4  0 39  4  0 38  4  0 37  3  0 46  4  0 45  4  0 45  1  0 36  1  0
 27  1  0 18  1  0  9  1  0  0  2  0  1  1  0  1  1  0  1  3  0 10  1  0
  1  0  0  1  3  0 10  0  0 10  1  0]
[40  4  0 39  1  0 30  4  0 29  1  0 20  1  0 11  4  0 10  1  0  1  3  0
 10  1  0  1  4  0  0  4  0  0  0  0  0  1  0  0  2  0  1  0  0  1  1  0
  1  0  0  1  0  0  1  3  0 10  1  0]
[40  1  0 31  0  0 31  1  0 22  3  0 31  4  0 30  3  0 39  3  0 48  4  0
 47  4  0 46  4  0 45  4  0 45  1  0 36  4  0 36  1  0 27  1  0 18  4  0
 18  0  0 18  4  0 18  1  0  9  4  0]
[40  0  0 40  4  0 39  4  0 38  0  0 38  4  0 37  4  0 36  4  0 36  1  0
 27  1  0 18  0  0 18  4  0 18  4  0 18  1  0  9  2  0 10  4  0  9  1  0
  0  2  0  1  1  0  1  0  0  1  2  0]
[40  1  0 31  4  0 30  0  0 30  4  0 29  1  0 20  3  0 29  4  0 28  4  0
 27  4  0 27  4  0 27  1  0 18  1  0  9  1  0  0  0  0  0  3  0  9  0  0
  9  4  0  9  4  0  9  1  0  0  2  0]
[40  3  0 49  4  0 48  4  0 47  1  0 38  4  0 37  4  0 36  0  0 36  4  0
 36  4  0 36  2  0 37  1  0 28  3  0 37  4  0 36  1  0 27  2  0 28  1  0
 19  0  0 19  4  0 18  0  0 18  1  0]
[40  1  0 31  4  0 30  4  0 29  0  0 29  4  0 28  1  0 19  4  0 18  4  0
 18  1  0  9  4  0  9  2  0 10  3  0 19  1  0 10  4  0  9  1  0  0  2  0
  1  0  0  1  4  0  0  2  0  1  1  0]
[40  4  0 39  4  0 38  4  0 37  4  0 36  4  0 36  1  0 27  0  0 27  1  0
 18  3  0 27  3  0 36  4  0 36  1  0 27  2  0 28  3  0 37  4  0 36  1  0
 27  4  0 27  4  0 27  4  0 27  4  0]
[40  4  0 39  4  0 38  4  0 37  4  0 36  4  0 36  3  0 45  1  0 36  4  0
 36  1  0 27  1  0 18  0  0 18  0  0 18  3  0 27  4  0 27  4  0 27  0  0
 27  0  0 27  4  0 27  3  0 36  4  0]
[40  1  0 31  4  0 30  4  0 29  1  0 20  4  0 19  1  0 10  1  0  1  0  0
  1  0  0  1  3  0 10  0  0 10  1  0  1  4  0  0  3  0  9  1  0  0  3  0
  9  0  0  9  4  0  9  1  0  0  1  0]
[40  4  0 39  4  0 38  4  0 37  1  0 28  1  0 19  1  0 10  1  0  1  2  0
  2  1  0  2  3  0 11  1  0  2  3  0 11  4  0 10  2  0 11  1  0  2  2  0
  3  4  0  2  2  0  3  4  0  2  2  0]
[40  4  0 39  1  0 30  1  0 21  3  0 30  1  0 21  4  0 20  1  0 11  3  0
 20  0  0 20  1  0 11  1  0  2  0  0  2  0  0  2  1  0  2  4  0  1  4  0
  0  2  0  1  3  0 10  4  0  9  0  0]
[40  4  0 39  4  0 38  1  0 29  4  0 28  0  0 28  4  0 27  1  0 18  1  0
  9  0  0  9  2  0 10  1  0  1  1  0  1  0  0  1  2  0  2  1  0  2  3  0
 11  0  0 11  0  0 11  0  0 11  2  0]
[40  4  0 39  1  0 30  2  0 31  4  0 30  4  0 29  1  0 20  4  0 19  1  0
 10  0  0 10  3  0 19  4  0 18  0  0 18  1  0  9  1  0  0  4  0  0  3  0
  9  2  0 10  1  0  1  4  0  0  0  0]
[40  4  0 39  4  0 38  1  0 29  4  0 28  4  0 27  4  0 27  2  0 28  1  0
 19  4  0 18  0  0 18  4  0 18  4  0 18  4  0 18  0  0 18  4  0 18  2  0
 19  3  0 28  1  0 19  1  0 10  4  0]
[40  4  0 39  0  0 39  4  0 38  4  0 37  4  0 36  1  0 27  4  0 27  4  0
 27  3  0 36  4  0 36  4  0 36  4  0 36  4  0 36  4  0 36  1  0 27  0  0
 27  0  0 27  4  0 27  4  0 27  1  0]
[40  1  0 31  4  0 30  4  0 29  4  0 28  1  0 19  1  0 10  0  0 10  4  0
  9  3  0 18  1  0  9  0  0  9  1  0  0  1  0  0  1  0  0  0  0  0  3  0
  9  1  0  0  4  0  0  1  0  0  1  0]
[40  4  0 39  1  0 30  3  0 39  1  0 30  4  0 29  0  0 29  3  0 38  4  0
 37  4  0 36  4  0 36  0  0 36  0  0 36  1  0 27  3  0 36  1  0 27  1  0
 18  4  0 18  3  0 27  1  0 18  3  0]
[40  1  0 31  1  0 22  4  0 21  4  0 20  1  0 11  3  0 20  1  0 11  3  0
 20  1  0 11  1  0  2  0  0  2  2  0  3  2  0  4  4  0  3  1  0  3  3  0

  0%|▍                                                                                                           | 43/10000 [00:03<06:26, 25.79it/s]
[40  0  0 40  1  0 31  0  0 31  0  0 31  4  0 30  1  0 21  1  0 12  3  0
 21  1  0 12  3  0 21  4  0 20  1  0 11  4  0 10  4  0  9  1  0  0  3  0
  9  3  0 18  2  0 19  4  0 18  2  0]
[40  0  0 40  4  0 39  4  0 38  4  0 37  4  0 36  1  0 27  2  0 28  1  0
 19  3  0 28  3  0 37  4  0 36  4  0 36  4  0 36  3  0 45  0  0 45  4  0
 45  1  0 36  4  0 36  1  0 27  4  0]
[40  1  0 31  1  0 22  4  0 21  0  0 21  4  0 20  3  0 29  0  0 29  4  0
 28  1  0 19  1  0 10  1  0  1  3  0 10  0  0 10  3  0 19  1  0 10  0  0
 10  1  0  1  3  0 10  4  0  9  1  0]
[40  4  0 39  4  0 38  4  0 37  1  0 28  0  0 28  4  0 27  4  0 27  3  0
 36  4  0 36  0  0 36  1  0 27  1  0 18  1  0  9  3  0 18  1  0  9  3  0
 18  3  0 27  4  0 27  1  0 18  1  0]
[40  4  0 39  4  0 38  4  0 37  1  0 28  2  0 29  4  0 28  4  0 27  1  0
 18  1  0  9  0  0  9  0  0  9  0  0  9  3  0 18  0  0 18  1  0  9  2  0
 10  2  0 11  1  0  2  2  0  3  1  0]
[40  4  0 39  4  0 38  4  0 37  1  0 28  1  0 19  1  0 10  4  0  9  2  0
 10  4  0  9  3  0 18  0  0 18  1  0  9  1  0  0  0  0  0  3  0  9  1  0
  0  1  0  0  3  0  9  2  0 10  0  0]
[40  4  0 39  4  0 38  1  0 29  3  0 38  1  0 29  4  0 28  1  0 19  2  0
 20  1  0 11  0  0 11  0  0 11  1  0  2  2  0  3  0  0  3  2  0  4  0  0
  4  1  0  4  0  0  4  0  0  4  1  0]
[40  1  0 31  4  0 30  1  0 21  1  0 12  0  0 12  2  0 13  4  0 12  0  0
 12  2  0 13  4  0 12  1  0  3  2  0  4  0  0  4  1  0  4  0  0  4  3  0
 13  1  0  4  1  0  4  3  0 13  1  0]
[40  0  0 40  4  0 39  1  0 30  2  0 31  4  0 30  1  0 21  0  0 21  1  0
 12  4  0 11  3  0 20  1  0 11  3  0 20  4  0 19  1  0 10  4  0  9  3  0
 18  4  0 18  1  0  9  1  0  0  0  0]
[40  0  0 40  4  0 39  4  0 38  3  0 47  4  0 46  1  0 37  4  0 36  2  0
 37  4  0 36  1  0 27  4  0 27  4  0 27  1  0 18  1  0  9  4  0  9  1  0
  0  3  0  9  0  0  9  0  0  9  1  0]
[40  1  0 31  1  0 22  1  0 13  1  0  4  3  0 13  3  0 22  4  0 21  1  0
 12  0  0 12  3  0 21  1  0 12  0  0 12  1  0  3  1  0  3  0  0  3  0  0
  3  4  0  2  3  0 11  3  0 20  3  0]
[40  4  0 39  3  0 48  3  0 57  4  0 56  4  0 55  4  0 54  0  0 54  4  0
 54  1  0 45  4  0 45  1  0 36  4  0 36  4  0 36  1  0 27  0  0 27  1  0
 18  1  0  9  1  0  0  2  0  1  2  0]
[40  1  0 31  4  0 30  1  0 21  1  0 12  4  0 11  1  0  2  1  0  2  1  0
  2  1  0  2  1  0  2  0  0  2  0  0  2  4  0  1  1  0  1  3  0 10  1  0
  1  2  0  2  0  0  2  2  0  3  1  0]
[40  1  0 31  4  0 30  4  0 29  1  0 20  4  0 19  4  0 18  4  0 18  1  0
  9  1  0  0  1  0  0  3  0  9  3  0 18  3  0 27  1  0 18  1  0  9  0  0
  9  3  0 18  4  0 18  4  0 18  4  0]
[40  4  0 39  1  0 30  4  0 29  1  0 20  1  0 11  1  0  2  0  0  2  4  0
  1  2  0  2  2  0  3  3  0 12  1  0  3  0  0  3  1  0  3  4  0  2  2  0
  3  2  0  4  0  0  4  4  0  3  4  0]
[40  4  0 39  1  0 30  0  0 30  4  0 29  4  0 28  4  0 27  4  0 27  4  0
 27  3  0 36  1  0 27  4  0 27  1  0 18  4  0 18  3  0 27  1  0 18  0  0
 18  4  0 18  4  0 18  4  0 18  0  0]
[40  1  0 31  1  0 22  1  0 13  4  0 12  1  0  3  0  0  3  3  0 12  0  0
 12  3  0 21  4  0 20  2  0 21  4  0 20  4  0 19  4  0 18  2  0 19  4  0
 18  3  0 27  2  0 28  4  0 27  1  0]
[40  4  0 39  4  0 38  4  0 37  1  0 28  1  0 19  1  0 10  1  0  1  1  0
  1  3  0 10  1  0  1  0  0  1  3  0 10  2  0 11  4  0 10  4  0  9  3  0
 18  1  0  9  4  0  9  1  0  0  1  0]
[40  4  0 39  3  0 48  1  0 39  1  0 30  4  0 29  1  0 20  1  0 11  4  0
 10  1  0  1  1  0  1  3  0 10  4  0  9  1  0  0  3  0  9  3  0 18  0  0
 18  1  0  9  0  0  9  1  0  0  4  0]
[40  3  0 49  1  0 40  0  0 40  4  0 39  1  0 30  1  0 21  0  0 21  1  0
 12  4  0 11  1  0  2  3  0 11  0  0 11  0  0 11  3  0 20  4  0 19  1  0
 10  2  0 11  1  0  2  3  0 11  4  0]
[40  4  0 39  1  0 30  1  0 21  0  0 21  4  0 20  4  0 19  1  0 10  1  0
  1  1  0  1  1  0  1  3  0 10  0  0 10  2  0 11  3  0 20  4  0 19  3  0
  1%|▋                                                                                                           | 62/10000 [00:04<10:56, 15.15it/s]
multiprocessing.pool.RemoteTraceback:
"""
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/generation_baselines/a2c.py", line 174, in calc_loss_on_episode
    if last_reward == 1 and np.random() < 0.7:
TypeError: 'module' object is not callable
"""
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./scripts/data_generation.py", line 197, in <module>
    main()
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/pyrallis/argparsing.py", line 158, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./scripts/data_generation.py", line 186, in main
    train_tasks = generate_histories(
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./scripts/data_generation.py", line 63, in generate_histories
    curr_history = generator.train_from_model(
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/generation_baselines/a2c.py", line 134, in train_from_model
    model, histories = train(config, environment)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/generation_baselines/a2c.py", line 309, in train
    parallel_results = pool.map(calc_loss_on_episode, args)
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 774, in get
    raise self._value
TypeError: 'module' object is not callable