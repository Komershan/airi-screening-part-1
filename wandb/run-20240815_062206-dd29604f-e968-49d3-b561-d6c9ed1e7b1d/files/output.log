[4 4] 0 0.0
[3 4] 1 0.0
[3 5] 2 0.0
[3 4] 4 0.0
[4 4] 3 0.0
[3 4] 1 0.0
[3 5] 2 0.0
[3 6] 2 0.0
[3 5] 4 0.0
[3 6] 2 0.0
[3 7] 2 0.0
[3 6] 4 0.0
[3 7] 2 0.0
[3 6] 4 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 6] 4 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 6] 4 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 6] 4 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 8] 0 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[3 7] 0 0.0
[3 7] 0 0.0
[3 7] 0 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[3 7] 0 0.0
[3 7] 0 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[3 7] 0 0.0
[3 7] 0 0.0
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.observation_to_int to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.observation_to_int` for environment variables or `env.get_wrapper_attr('observation_to_int')` that will search the reminding wrappers.
  logger.warn(
/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.state_to_pos to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.state_to_pos` for environment variables or `env.get_wrapper_attr('state_to_pos')` that will search the reminding wrappers.
  logger.warn(
[3 8] 2 0.0
[4 8] 3 0.0
[3 8] 1 0.0
[3 8] 0 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[3 6] 4 0.0
[3 5] 4 0.0
[4 5] 3 0.0
[3 5] 1 0.0
[3 6] 2 0.0
[3 7] 2 0.0
[3 6] 4 0.0
[3 6] 0 0.0
[3 5] 4 0.0
[4 5] 3 0.0
[3 5] 1 0.0
[3 5] 0 0.0
[3 5] 0 0.0
[4 5] 3 0.0
[3 5] 1 0.0
[3 5] 0 0.0
[3 5] 0 0.0
[4 5] 3 0.0
[3 5] 1 0.0
[3 5] 0 0.0
[3 6] 2 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[3 8] 0 0.0
[3 8] 2 0.0
[3 8] 0 0.0
[3 8] 2 0.0
[3 8] 0 0.0
[3 8] 2 0.0
[3 8] 0 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 0 0.0
[3 8] 0 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 6] 4 0.0
[3 6] 0 0.0
[3 5] 4 0.0
[3 6] 2 0.0
[3 7] 2 0.0
[3 6] 4 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[3 6] 4 0.0
[4 6] 3 0.0
[3 6] 1 0.0
[4 6] 3 0.0
[3 6] 1 0.0
[3 5] 4 0.0
[4 5] 3 0.0
[3 5] 1 0.0
[4 5] 3 0.0
[3 5] 1 0.0
[3 5] 0 0.0
[3 5] 0 0.0
[3 4] 4 0.0
[3 4] 0 0.0
[3 3] 4 0.0
[4 3] 3 0.0
[3 3] 1 0.0
[3 4] 2 0.0
[3 5] 2 0.0
[3 6] 2 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 0 0.0
[3 8] 0 0.0
[3 8] 0 0.0
[3 8] 0 0.0
[3 8] 0 0.0
[3 8] 2 0.0
[3 8] 0 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 6] 4 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[3 6] 4 0.0
[3 5] 4 0.0
[3 4] 4 0.0
[3 3] 4 0.0
[3 4] 2 0.0
[3 4] 0 0.0
[3 3] 4 0.0
[3 4] 2 0.0
[3 3] 4 0.0
[3 4] 2 0.0
[3 4] 0 0.0
[3 4] 0 0.0
[3 4] 0 0.0
[3 5] 2 0.0
[3 6] 2 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[3 7] 4 0.0
[3 6] 4 0.0
[3 7] 2 0.0
[3 6] 4 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 0 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[3 6] 4 0.0
[3 5] 4 0.0
[3 4] 4 0.0
[3 5] 2 0.0
[3 4] 4 0.0
[3 4] 0 0.0
[3 4] 0 0.0
[3 5] 2 0.0
[3 6] 2 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[2 8] 0 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[3 7] 4 0.0
[3 6] 4 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 7] 0 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[3 8] 0 0.0
[3 8] 0 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[2 8] 1 0.0
[3 8] 3 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 7] 0 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[3 7] 0 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[3 6] 4 0.0
[3 6] 0 0.0
[3 6] 0 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[3 6] 0 0.0
[2 6] 1 0.0
[3 6] 3 0.0
[3 6] 0 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 6] 4 0.0
[3 7] 2 0.0
[3 6] 4 0.0
[3 5] 4 0.0
[3 6] 2 0.0
[4 6] 3 0.0
[3 6] 1 0.0
[3 6] 0 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 6] 4 0.0
[3 5] 4 0.0
[3 5] 0 0.0
[3 5] 0 0.0
[4 5] 3 0.0
[3 5] 1 0.0
[4 5] 3 0.0
[3 5] 1 0.0
[3 5] 0 0.0
[4 5] 3 0.0
[3 5] 1 0.0
[4 5] 3 0.0
[3 5] 1 0.0
[3 6] 2 0.0
[3 6] 0 0.0
[3 7] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 0 0.0
[3 8] 2 0.0
[3 8] 0 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[4 7] 3 0.0
[3 7] 1 0.0
[4 7] 3 0.0
[4 7] 0 0.0
[3 7] 1 0.0
[3 6] 4 0.0
[4 6] 3 0.0
[3 6] 1 0.0
[3 6] 0 0.0
[3 6] 0 0.0
[3 6] 0 0.0
[3 6] 0 0.0
[4 6] 3 0.0
[3 6] 1 0.0
[4 6] 3 0.0
[3 6] 1 0.0
[4 6] 3 0.0
[3 6] 1 0.0
[3 6] 0 0.0
[3 6] 0 0.0
[3 7] 2 0.0
[3 7] 0 0.0
[3 8] 2 0.0
[3 8] 0 0.0
[3 8] 2 0.0
[3 8] 0 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
Traceback (most recent call last):
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./scripts/compare_arena.py", line 149, in <module>
    benchmark()
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/pyrallis/argparsing.py", line 158, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./scripts/compare_arena.py", line 141, in benchmark
    total_reward_model = run_env(checkpoint_model, config, agent_name=f"{checkpoint}", sampled_task=sampled_task, finish=False)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/./scripts/compare_arena.py", line 56, in run_env
    action = model.get_action(environment.observation_to_int())
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/in_context_learning/AD.py", line 195, in get_action
    logits, loss = self.forward(torch.LongTensor([self.history[-(self.config.block_size - 2):]]))
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/in_context_learning/AD.py", line 170, in forward
    x = block(x)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/utils.py", line 181, in forward
    x = x + self.mlpf(self.ln_2(x))
  File "/home/aaderevyagin/airi_final/airi-screening-part-1/algorithms/utils.py", line 177, in <lambda>
    self.mlpf = lambda x: m.dropout(m.c_proj(m.act(m.c_fc(x)))) # MLP forward
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aaderevyagin/airi_final/venv/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
[3 8] 2 0.0
[3 8] 2 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[3 8] 2 0.0
[3 7] 4 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[2 7] 1 0.0
[3 7] 3 0.0
[3 6] 4 0.0
[3 5] 4 0.0
[3 4] 4 0.0
[3 5] 2 0.0
[3 5] 0 0.0
[3 6] 2 0.0
[3 5] 4 0.0
[3 6] 2 0.0
[3 5] 4 0.0
[3 6] 2 0.0
[3 5] 4 0.0
[3 5] 0 0.0